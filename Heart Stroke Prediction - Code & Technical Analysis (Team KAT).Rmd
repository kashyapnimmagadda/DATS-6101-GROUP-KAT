---
title: "Heart Stroke Prediction - Code & Technical Analysis"
author: "Team KAT"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: TRUE
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r basic_libraries, include=FALSE}
library(ezids)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(ROSE)
library(dplyr)

```
# Loading the dataset
```{r load_csv, include=TRUE, echo=TRUE}
# reading the dataset
stroke_df <- read.csv("C:/Users/Admin/OneDrive/Desktop/DataSet/framingham.csv", header = TRUE)
stroke_df
```

```{r desc, include=TRUE, echo=TRUE}
# structure of the dataset
str(stroke_df)
```
# Data Cleaning and summary of the dataset
```{r data_cleaning, include=TRUE, echo=TRUE}

colnames(stroke_df)[1] <- "gender"
stroke_df$gender[stroke_df$gender == "0"] <- "F"
stroke_df$gender[stroke_df$gender == "1"] <- "M"
# converting the numeric variables to factor variables
stroke_df$gender = as.factor(stroke_df$gender)
stroke_df$education = as.factor(stroke_df$education)
stroke_df$currentSmoker = as.factor(stroke_df$currentSmoker)
stroke_df$BPMeds = as.factor(stroke_df$BPMeds)
stroke_df$prevalentStroke = as.factor(stroke_df$prevalentStroke)
stroke_df$prevalentHyp = as.factor(stroke_df$prevalentHyp)
stroke_df$diabetes = as.factor(stroke_df$diabetes)
stroke_df$TenYearCHD = as.factor(stroke_df$TenYearCHD)
stroke_df$BMI = as.numeric(stroke_df$BMI)

# To get the summary statistics of the dataset
summary(stroke_df)

```


```{r find_na_fix, include=TRUE, echo=TRUE}
# To find the NA's in the dataset
paste("The NA's in the dataset is:",sum(is.na(stroke_df)))

```

```{r na_fix, include=TRUE, echo=TRUE}

# Replacing NA values with average BMI value
stroke_df$BMI[is.na(stroke_df$BMI)] = mean(stroke_df$BMI,na.rm = TRUE)

# Replacing NA values with average glucose value
stroke_df$glucose[is.na(stroke_df$glucose)] = mean(stroke_df$glucose,na.rm = TRUE)

# Replacing NA values with average heartRate value
stroke_df$heartRate[is.na(stroke_df$heartRate)] = mean(stroke_df$heartRate,na.rm = TRUE)

# Replacing NA values with average cigsPerDay value
stroke_df$cigsPerDay[is.na(stroke_df$cigsPerDay)] = mean(stroke_df$cigsPerDay,na.rm = TRUE)

# Replacing NA values with average totChol value
stroke_df$totChol[is.na(stroke_df$totChol)] = mean(stroke_df$totChol,na.rm = TRUE)

# Replacing education NA values with Unknown value
stroke_df$education <- ifelse(is.na(stroke_df$education), "Unknown", stroke_df$education)

# Replacing BPMeds NA values with Unknown value
stroke_df$BPMeds <- ifelse(is.na(stroke_df$BPMeds), "Unknown", stroke_df$BPMeds)

paste("The NA's in the dataset after replacing values is:",sum(is.na(stroke_df)))
```
# Subsetting of the dataset
```{r subsets, include=TRUE, echo=TRUE}
# subsetting the data for various analyses 
stroke_1 = subset(stroke_df, prevalentStroke == 1)
stroke_0 = subset(stroke_df, prevalentStroke == 0)
stroke_1_female = subset(stroke_df, prevalentStroke == 1 & gender == "Female")
stroke_1_male = subset(stroke_df, prevalentStroke == 1 & gender == "Male")
```

```{r}
#Relcaing all Null values with 0
#stroke_df[is.na(stroke_df)] <- 0
summary(stroke_df)
```




